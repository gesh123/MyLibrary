import {AbstractConnection} from "../AbstractConnection";
import {DevConsole} from "../../devTools/console/DevConsole";
import {SignalOne} from "../../signals/SignalOne";
import {Signal} from "../../signals/Signal";
import {PokerWebSocket} from "./PokerWebSocket";

/**
 * Created by hivaga on 7/14/2016.
 */
export class FlashDumpReplaySocket implements AbstractConnection
{
	public connectionURL:string;

	public onData = new SignalOne<ArrayBuffer>();
	public onStateChange = new SignalOne<number>();
	public onClosing = new Signal();
	public onClosed = new Signal();
	public onConnecting = new Signal();
	public onConnected = new Signal();
	public onError = new SignalOne<ErrorEvent>();

	protected currentCommandFile:string;

	protected commandsDir = "./assets/dump/jpt/";
	//protected commandsList = ["001_ClSSLDataCommand.json", "002_SrvSSLDataCommand.json", "003_ClSSLDataCommand.json", "004_SrvSSLDataCommand.json", "005_ClHandShakeCommand.json", "006_SrvHandShakeOKCommand.json", "007_ClConnectGame.json", "008_SrvConnectGameOK.json", "009_ClGetSyncBreakInfo.json", "010_ClSubscribeForJackpots.json", "011_ClSubscribeForSnGBeastJackpot.json", "012_SrvNews.json", "013_SrvNetworksConfiguration.json", "014_SrvNetworkPolicyChange.json", "015_SrvSyncBreakInfo.json", "016_SrvSetJackpots.json", "017_ClSubscribeForBBJNotifications.json", "018_SrvSetSnGBeastJackpot.json", "019_ClSSLDataCommand.json", "020_SrvLogonOk.json", "021_ClMiscCashierInfo.json", "022_ClGetPlayerProfile.json", "023_ClGetServerInfo.json", "024_SrvAltCurrencyRate.json", "025_SrvPlayerParticipations.json", "026_SrvUnreadMessageCount.json", "027_SrvServerInfo.json", "028_SrvPlayerProfile.json", "029_SrvCashierStatus.json", "030_ClSubscribeForTournamentTemplatesInfo.json", "031_SrvTournamentTemplatesInfo.json", "032_ClSubscribeForTournamentTemplateDetailsInfo.json", "033_SrvRecentWinners.json", "034_ClSSLDataCommand.json", "035_SrvSSLDataCommand.json", "036_ClSSLDataCommand.json", "037_SrvSSLDataCommand.json", "038_ClHandShakeCommand.json", "039_SrvHandShakeOKCommand.json", "040_ClConnectGame.json", "041_SrvConnectGameOK.json", "042_ClSSLDataCommand.json", "043_SrvLogonOk.json", "044_ClGetJackpotTourBuyInInfo.json", "045_SrvJackpotTourBuyInInfo.json", "046_ClJackpotTourRegRequest.json", "047_SrvJackpotTourRegRequest.json", "048_SrvPlayerTourInfo.json", "049_SrvJackpotTourPlayerRegistered.json", "050_SrvCanObserveTourTemplateTable.json", "051_SrvTourCountersInfo.json", "052_SrvTakeSeatInfo.json", "053_ClGetTourDetails.json", "054_ClPeekTournamentsInfo.json", "055_SrvTourDetails.json", "056_SrvTournamentsInfoSnapshot.json", "057_SrvServerCountersInfo.json", "058_SrvTourCountersInfo.json", "059_ClSSLDataCommand.json", "060_SrvSSLDataCommand.json", "061_ClSSLDataCommand.json", "062_SrvSSLDataCommand.json", "063_ClHandShakeCommand.json", "064_SrvHandShakeOKCommand.json", "065_ClConnectGame.json", "066_SrvTourSittingOutPlayers.json", "067_SrvTableState.json", "068_SrvUpdateHintText.json", "069_SrvConnectGameOK.json", "070_ClGetTourTableInfo.json", "071_SrvStartSelectingBuyInMultiplier.json", "072_ClSSLDataCommand.json", "073_SrvTourTableInfo.json", "074_SrvLogonOk.json", "075_ClGetExtraMoneyInfo.json", "076_ClSitDown.json", "077_SrvUserStateOnTable.json", "078_SrvGetExtraMoneyReply.json", "079_SrvUserStateOnTable.json", "080_SrvUpdateHintText.json", "081_SrvTableState.json", "082_SrvBackOnSeatOk.json", "083_ClChatMsg.json", "084_SrvUpdateHintText.json", "085_SrvTourPlayerBackOnTable.json", "086_SrvUserStateOnTable.json", "087_ClActionInAdvance.json", "088_SrvPlayerChatMsg.json", "089_SrvJackpotTourPrizeInfo.json", "090_SrvTourTourneyStatus.json", "091_SrvTourDetails.json", "092_SrvTourStartTimeChange.json", "093_SrvGetExtraMoneyReply.json", "094_SrvLevelSwitch.json", "095_SrvUpdateHintText.json", "096_SrvGameStart.json", "097_SrvTableState.json", "098_SrvHoldemPlayerPos.json", "099_SrvMoveDealChip.json", "100_SrvUserActionNotify.json", "101_SrvUserActionNotify.json", "102_SrvBetRoundComplete.json", "103_SrvCardDeal.json", "104_SrvBetRoundStart.json", "105_SrvUserTurn.json", "106_ClPing.json", "107_SrvPing.json", "108_ClPing.json", "109_ClUserAction.json", "110_SrvUserActionNotify.json", "111_SrvUserTurn.json", "112_SrvUserActionNotify.json", "113_SrvUserTurn.json", "114_SrvUserActionNotify.json", "115_SrvBetRoundComplete.json", "116_SrvPotCardDeal.json", "117_SrvBetRoundStart.json", "118_SrvUserTurn.json", "119_SrvUserActionNotify.json", "120_SrvUserTurn.json", "121_SrvUserActionNotify.json", "122_SrvUserTurn.json", "123_ClPing.json", "124_SrvPing.json", "125_ClPing.json", "126_ClUserAction.json", "127_SrvUserActionNotify.json", "128_SrvUserTurn.json", "129_SrvUserActionNotify.json", "130_SrvBetRoundComplete.json", "131_SrvPotCardDeal.json", "132_SrvBetRoundStart.json", "133_SrvUserTurn.json", "134_SrvUserActionNotify.json", "135_SrvUserTurn.json", "136_SrvUserActionNotify.json", "137_SrvUserTurn.json", "138_ClPing.json", "139_SrvPing.json", "140_ClPing.json", "141_ClUserAction.json", "142_SrvUserActionNotify.json", "143_SrvUserTurn.json", "144_SrvUserActionNotify.json", "145_SrvBetRoundComplete.json", "146_SrvPotCardDeal.json", "147_SrvBetRoundStart.json", "148_SrvUserTurn.json", "149_SrvUserActionNotify.json", "150_SrvUserTurn.json", "151_SrvUserActionNotify.json", "152_SrvUserTurn.json", "153_ClPing.json", "154_SrvPing.json", "155_ClPing.json", "156_ClUserAction.json", "157_SrvUserActionNotify.json", "158_SrvBetRoundComplete.json", "159_SrvBetRoundStart.json", "160_SrvTableState.json", "161_SrvUserActionNotify.json", "162_SrvUserTurn.json", "163_SrvUserActionNotify.json", "164_SrvTableState.json", "165_SrvUserActionNotify.json", "166_SrvShowHands.json", "167_SrvHandWinners.json", "168_SrvTUShowDown.json", "169_SrvTableState.json", "170_SrvLevelSwitch.json", "171_SrvUpdateHintText.json", "172_SrvUpdateHintText.json", "173_SrvGameStart.json", "174_SrvTableState.json", "175_SrvHoldemPlayerPos.json", "176_SrvMoveDealChip.json", "177_SrvUserActionNotify.json", "178_SrvUserActionNotify.json", "179_SrvBetRoundComplete.json", "180_SrvCardDeal.json", "181_SrvBetRoundStart.json", "182_SrvUserTurn.json", "183_SrvUserActionNotify.json", "184_SrvUserTurn.json", "185_SrvUserActionNotify.json", "186_SrvUserTurn.json", "187_ClPing.json", "188_SrvPing.json", "189_ClPing.json", "190_ClUserAction.json", "191_SrvUserActionNotify.json", "192_SrvBetRoundComplete.json", "193_SrvPotCardDeal.json", "194_SrvBetRoundStart.json", "195_SrvUserTurn.json", "196_SrvUserActionNotify.json", "197_SrvUserTurn.json", "198_ClPing.json", "199_SrvPing.json", "200_ClPing.json", "201_ClUserAction.json", "202_SrvUserActionNotify.json", "203_SrvUserTurn.json", "204_SrvUserActionNotify.json", "205_SrvUserTurn.json", "206_SrvUserActionNotify.json", "207_SrvBetRoundComplete.json", "208_SrvPotCardDeal.json", "209_SrvBetRoundStart.json", "210_SrvUserTurn.json", "211_SrvUserActionNotify.json", "212_SrvUserTurn.json", "213_ClPing.json", "214_SrvPing.json", "215_ClPing.json", "216_ClUserAction.json", "217_SrvUserActionNotify.json", "218_SrvUserTurn.json", "219_SrvUserActionNotify.json", "220_SrvUserTurn.json", "221_SrvUserActionNotify.json", "222_SrvTableState.json", "223_SrvTransferUncalledBet.json", "224_SrvBetRoundComplete.json", "225_SrvPotCardDeal.json", "226_SrvBetRoundStart.json", "227_SrvTableState.json", "228_SrvBetRoundComplete.json", "229_SrvHandWinners.json", "230_SrvTUShowDown.json", "231_SrvTableState.json", "232_SrvLevelSwitch.json", "233_SrvUpdateHintText.json", "234_SrvUpdateHintText.json", "235_SrvGameStart.json", "236_SrvTableState.json", "237_SrvHoldemPlayerPos.json", "238_SrvMoveDealChip.json", "239_SrvUserActionNotify.json", "240_SrvUserActionNotify.json", "241_SrvBetRoundComplete.json", "242_SrvCardDeal.json", "243_SrvBetRoundStart.json", "244_SrvUserTurn.json", "245_SrvUserActionNotify.json", "246_SrvUserTurn.json", "247_ClPing.json", "248_SrvPing.json", "249_ClPing.json", "250_ClUserAction.json", "251_SrvUserActionNotify.json", "252_SrvUserTurn.json", "253_SrvUserActionNotify.json", "254_SrvUserTurn.json", "255_SrvUserActionNotify.json", "256_SrvTableState.json", "257_SrvTransferUncalledBet.json", "258_SrvBetRoundComplete.json", "259_SrvPotCardDeal.json", "260_SrvBetRoundStart.json", "261_SrvTableState.json", "262_SrvBetRoundComplete.json", "263_SrvPotCardDeal.json", "264_SrvBetRoundStart.json", "265_SrvTableState.json", "266_SrvBetRoundComplete.json", "267_SrvPotCardDeal.json", "268_SrvBetRoundStart.json", "269_SrvTableState.json", "270_SrvBetRoundComplete.json", "271_SrvHandWinners.json", "272_SrvTUShowDown.json", "273_SrvTableState.json", "274_SrvLevelSwitch.json", "275_SrvUpdateHintText.json", "276_SrvUpdateHintText.json", "277_SrvGameStart.json", "278_SrvTableState.json", "279_SrvHoldemPlayerPos.json", "280_SrvMoveDealChip.json", "281_SrvUserActionNotify.json", "282_SrvUserActionNotify.json", "283_SrvBetRoundComplete.json", "284_SrvCardDeal.json", "285_SrvBetRoundStart.json", "286_SrvUserTurn.json", "287_ClPing.json", "288_SrvPing.json", "289_ClPing.json", "290_ClUserAction.json", "291_SrvUserActionNotify.json", "292_SrvUserTurn.json", "293_SrvUserActionNotify.json", "294_SrvUserTurn.json", "295_SrvUserActionNotify.json", "296_SrvBetRoundComplete.json", "297_SrvPotCardDeal.json", "298_SrvBetRoundStart.json", "299_SrvUserTurn.json", "300_SrvUserActionNotify.json", "301_SrvUserTurn.json", "302_SrvUserActionNotify.json", "303_SrvUserTurn.json", "304_ClPing.json", "305_SrvPing.json", "306_ClPing.json", "307_ClUserAction.json", "308_SrvUserActionNotify.json", "309_SrvUserTurn.json", "310_SrvUserActionNotify.json", "311_SrvUserTurn.json", "312_SrvUserActionNotify.json", "313_SrvBetRoundComplete.json", "314_SrvPotCardDeal.json", "315_SrvBetRoundStart.json", "316_SrvUserTurn.json", "317_SrvUserActionNotify.json", "318_SrvUserTurn.json", "319_SrvUserActionNotify.json", "320_SrvUserTurn.json", "321_ClPing.json", "322_SrvPing.json", "323_ClPing.json", "324_ClUserAction.json", "325_SrvUserActionNotify.json", "326_SrvUserTurn.json", "327_SrvUserActionNotify.json", "328_SrvUserTurn.json", "329_SrvUserActionNotify.json", "330_SrvBetRoundComplete.json", "331_SrvPotCardDeal.json", "332_SrvBetRoundStart.json", "333_SrvUserTurn.json", "334_SrvUserActionNotify.json", "335_SrvUserTurn.json", "336_SrvUserActionNotify.json", "337_SrvUserTurn.json", "338_ClPing.json", "339_SrvPing.json", "340_ClPing.json", "341_ClUserAction.json", "342_SrvUserActionNotify.json", "343_SrvUserTurn.json", "344_SrvUserActionNotify.json", "345_SrvUserTurn.json", "346_SrvUserActionNotify.json", "347_SrvTableState.json", "348_SrvTransferUncalledBet.json", "349_SrvBetRoundComplete.json", "350_SrvShowHands.json", "351_SrvHandWinners.json", "352_SrvTUShowDown.json", "353_SrvTableState.json", "354_SrvTableState.json", "355_SrvTableState.json", "356_SrvFinishedOnPlace.json", "357_SrvFinishedOnPlace.json", "358_SrvTableState.json", "359_SrvTourPlayerFinished.json", "360_SrvUserStateOnTable.json", "361_SrvPlayerTourInfo.json", "362_SrvRecentWinners.json", "363_SrvTourFinishedInfo.json", "364_ClByeCommand.json", "365_ClUnsubscribeFromJackpots.json", "366_ClUnsubscribeFromSnGBeastJackpot.json", "367_ClByeCommand.json"];
	protected commandsList = ["005_ClHandShakeCommand.json", "006_SrvHandShakeOKCommand.json", "007_ClConnectGame.json", "008_SrvConnectGameOK.json", "009_ClGetSyncBreakInfo.json", "010_ClSubscribeForJackpots.json", "011_ClSubscribeForSnGBeastJackpot.json", "012_SrvNews.json", "013_SrvNetworksConfiguration.json", "014_SrvNetworkPolicyChange.json", "015_SrvSyncBreakInfo.json", "016_SrvSetJackpots.json", "017_ClSubscribeForBBJNotifications.json", "018_SrvSetSnGBeastJackpot.json", "019_ClSSLDataCommand.json", "020_SrvLogonOk.json", "021_ClMiscCashierInfo.json", "022_ClGetPlayerProfile.json", "023_ClGetServerInfo.json", "024_SrvAltCurrencyRate.json", "025_SrvPlayerParticipations.json", "026_SrvUnreadMessageCount.json", "027_SrvServerInfo.json", "028_SrvPlayerProfile.json", "029_SrvCashierStatus.json", "030_ClSubscribeForTournamentTemplatesInfo.json", "031_SrvTournamentTemplatesInfo.json", "032_ClSubscribeForTournamentTemplateDetailsInfo.json", "033_SrvRecentWinners.json", "034_ClSSLDataCommand.json", "035_SrvSSLDataCommand.json", "036_ClSSLDataCommand.json", "037_SrvSSLDataCommand.json", "038_ClHandShakeCommand.json", "039_SrvHandShakeOKCommand.json", "040_ClConnectGame.json", "041_SrvConnectGameOK.json", "042_ClSSLDataCommand.json", "043_SrvLogonOk.json", "044_ClGetJackpotTourBuyInInfo.json", "045_SrvJackpotTourBuyInInfo.json", "046_ClJackpotTourRegRequest.json", "047_SrvJackpotTourRegRequest.json", "048_SrvPlayerTourInfo.json", "049_SrvJackpotTourPlayerRegistered.json", "050_SrvCanObserveTourTemplateTable.json", "051_SrvTourCountersInfo.json", "052_SrvTakeSeatInfo.json", "053_ClGetTourDetails.json", "054_ClPeekTournamentsInfo.json", "055_SrvTourDetails.json", "056_SrvTournamentsInfoSnapshot.json", "057_SrvServerCountersInfo.json", "058_SrvTourCountersInfo.json", "059_ClSSLDataCommand.json", "060_SrvSSLDataCommand.json", "061_ClSSLDataCommand.json", "062_SrvSSLDataCommand.json", "063_ClHandShakeCommand.json", "064_SrvHandShakeOKCommand.json", "065_ClConnectGame.json", "066_SrvTourSittingOutPlayers.json", "067_SrvTableState.json", "068_SrvUpdateHintText.json", "069_SrvConnectGameOK.json", "070_ClGetTourTableInfo.json", "071_SrvStartSelectingBuyInMultiplier.json", "072_ClSSLDataCommand.json", "073_SrvTourTableInfo.json", "074_SrvLogonOk.json", "075_ClGetExtraMoneyInfo.json", "076_ClSitDown.json", "077_SrvUserStateOnTable.json", "078_SrvGetExtraMoneyReply.json", "079_SrvUserStateOnTable.json", "080_SrvUpdateHintText.json", "081_SrvTableState.json", "082_SrvBackOnSeatOk.json", "083_ClChatMsg.json", "084_SrvUpdateHintText.json", "085_SrvTourPlayerBackOnTable.json", "086_SrvUserStateOnTable.json", "087_ClActionInAdvance.json", "088_SrvPlayerChatMsg.json", "089_SrvJackpotTourPrizeInfo.json", "090_SrvTourTourneyStatus.json", "091_SrvTourDetails.json", "092_SrvTourStartTimeChange.json", "093_SrvGetExtraMoneyReply.json", "094_SrvLevelSwitch.json", "095_SrvUpdateHintText.json", "096_SrvGameStart.json", "097_SrvTableState.json", "098_SrvHoldemPlayerPos.json", "099_SrvMoveDealChip.json", "100_SrvUserActionNotify.json", "101_SrvUserActionNotify.json", "102_SrvBetRoundComplete.json", "103_SrvCardDeal.json", "104_SrvBetRoundStart.json", "105_SrvUserTurn.json", "106_ClPing.json", "107_SrvPing.json", "108_ClPing.json", "109_ClUserAction.json", "110_SrvUserActionNotify.json", "111_SrvUserTurn.json", "112_SrvUserActionNotify.json", "113_SrvUserTurn.json", "114_SrvUserActionNotify.json", "115_SrvBetRoundComplete.json", "116_SrvPotCardDeal.json", "117_SrvBetRoundStart.json", "118_SrvUserTurn.json", "119_SrvUserActionNotify.json", "120_SrvUserTurn.json", "121_SrvUserActionNotify.json", "122_SrvUserTurn.json", "123_ClPing.json", "124_SrvPing.json", "125_ClPing.json", "126_ClUserAction.json", "127_SrvUserActionNotify.json", "128_SrvUserTurn.json", "129_SrvUserActionNotify.json", "130_SrvBetRoundComplete.json", "131_SrvPotCardDeal.json", "132_SrvBetRoundStart.json", "133_SrvUserTurn.json", "134_SrvUserActionNotify.json", "135_SrvUserTurn.json", "136_SrvUserActionNotify.json", "137_SrvUserTurn.json", "138_ClPing.json", "139_SrvPing.json", "140_ClPing.json", "141_ClUserAction.json", "142_SrvUserActionNotify.json", "143_SrvUserTurn.json", "144_SrvUserActionNotify.json", "145_SrvBetRoundComplete.json", "146_SrvPotCardDeal.json", "147_SrvBetRoundStart.json", "148_SrvUserTurn.json", "149_SrvUserActionNotify.json", "150_SrvUserTurn.json", "151_SrvUserActionNotify.json", "152_SrvUserTurn.json", "153_ClPing.json", "154_SrvPing.json", "155_ClPing.json", "156_ClUserAction.json", "157_SrvUserActionNotify.json", "158_SrvBetRoundComplete.json", "159_SrvBetRoundStart.json", "160_SrvTableState.json", "161_SrvUserActionNotify.json", "162_SrvUserTurn.json", "163_SrvUserActionNotify.json", "164_SrvTableState.json", "165_SrvUserActionNotify.json", "166_SrvShowHands.json", "167_SrvHandWinners.json", "168_SrvTUShowDown.json", "169_SrvTableState.json", "170_SrvLevelSwitch.json", "171_SrvUpdateHintText.json", "172_SrvUpdateHintText.json", "173_SrvGameStart.json", "174_SrvTableState.json", "175_SrvHoldemPlayerPos.json", "176_SrvMoveDealChip.json", "177_SrvUserActionNotify.json", "178_SrvUserActionNotify.json", "179_SrvBetRoundComplete.json", "180_SrvCardDeal.json", "181_SrvBetRoundStart.json", "182_SrvUserTurn.json", "183_SrvUserActionNotify.json", "184_SrvUserTurn.json", "185_SrvUserActionNotify.json", "186_SrvUserTurn.json", "187_ClPing.json", "188_SrvPing.json", "189_ClPing.json", "190_ClUserAction.json", "191_SrvUserActionNotify.json", "192_SrvBetRoundComplete.json", "193_SrvPotCardDeal.json", "194_SrvBetRoundStart.json", "195_SrvUserTurn.json", "196_SrvUserActionNotify.json", "197_SrvUserTurn.json", "198_ClPing.json", "199_SrvPing.json", "200_ClPing.json", "201_ClUserAction.json", "202_SrvUserActionNotify.json", "203_SrvUserTurn.json", "204_SrvUserActionNotify.json", "205_SrvUserTurn.json", "206_SrvUserActionNotify.json", "207_SrvBetRoundComplete.json", "208_SrvPotCardDeal.json", "209_SrvBetRoundStart.json", "210_SrvUserTurn.json", "211_SrvUserActionNotify.json", "212_SrvUserTurn.json", "213_ClPing.json", "214_SrvPing.json", "215_ClPing.json", "216_ClUserAction.json", "217_SrvUserActionNotify.json", "218_SrvUserTurn.json", "219_SrvUserActionNotify.json", "220_SrvUserTurn.json", "221_SrvUserActionNotify.json", "222_SrvTableState.json", "223_SrvTransferUncalledBet.json", "224_SrvBetRoundComplete.json", "225_SrvPotCardDeal.json", "226_SrvBetRoundStart.json", "227_SrvTableState.json", "228_SrvBetRoundComplete.json", "229_SrvHandWinners.json", "230_SrvTUShowDown.json", "231_SrvTableState.json", "232_SrvLevelSwitch.json", "233_SrvUpdateHintText.json", "234_SrvUpdateHintText.json", "235_SrvGameStart.json", "236_SrvTableState.json", "237_SrvHoldemPlayerPos.json", "238_SrvMoveDealChip.json", "239_SrvUserActionNotify.json", "240_SrvUserActionNotify.json", "241_SrvBetRoundComplete.json", "242_SrvCardDeal.json", "243_SrvBetRoundStart.json", "244_SrvUserTurn.json", "245_SrvUserActionNotify.json", "246_SrvUserTurn.json", "247_ClPing.json", "248_SrvPing.json", "249_ClPing.json", "250_ClUserAction.json", "251_SrvUserActionNotify.json", "252_SrvUserTurn.json", "253_SrvUserActionNotify.json", "254_SrvUserTurn.json", "255_SrvUserActionNotify.json", "256_SrvTableState.json", "257_SrvTransferUncalledBet.json", "258_SrvBetRoundComplete.json", "259_SrvPotCardDeal.json", "260_SrvBetRoundStart.json", "261_SrvTableState.json", "262_SrvBetRoundComplete.json", "263_SrvPotCardDeal.json", "264_SrvBetRoundStart.json", "265_SrvTableState.json", "266_SrvBetRoundComplete.json", "267_SrvPotCardDeal.json", "268_SrvBetRoundStart.json", "269_SrvTableState.json", "270_SrvBetRoundComplete.json", "271_SrvHandWinners.json", "272_SrvTUShowDown.json", "273_SrvTableState.json", "274_SrvLevelSwitch.json", "275_SrvUpdateHintText.json", "276_SrvUpdateHintText.json", "277_SrvGameStart.json", "278_SrvTableState.json", "279_SrvHoldemPlayerPos.json", "280_SrvMoveDealChip.json", "281_SrvUserActionNotify.json", "282_SrvUserActionNotify.json", "283_SrvBetRoundComplete.json", "284_SrvCardDeal.json", "285_SrvBetRoundStart.json", "286_SrvUserTurn.json", "287_ClPing.json", "288_SrvPing.json", "289_ClPing.json", "290_ClUserAction.json", "291_SrvUserActionNotify.json", "292_SrvUserTurn.json", "293_SrvUserActionNotify.json", "294_SrvUserTurn.json", "295_SrvUserActionNotify.json", "296_SrvBetRoundComplete.json", "297_SrvPotCardDeal.json", "298_SrvBetRoundStart.json", "299_SrvUserTurn.json", "300_SrvUserActionNotify.json", "301_SrvUserTurn.json", "302_SrvUserActionNotify.json", "303_SrvUserTurn.json", "304_ClPing.json", "305_SrvPing.json", "306_ClPing.json", "307_ClUserAction.json", "308_SrvUserActionNotify.json", "309_SrvUserTurn.json", "310_SrvUserActionNotify.json", "311_SrvUserTurn.json", "312_SrvUserActionNotify.json", "313_SrvBetRoundComplete.json", "314_SrvPotCardDeal.json", "315_SrvBetRoundStart.json", "316_SrvUserTurn.json", "317_SrvUserActionNotify.json", "318_SrvUserTurn.json", "319_SrvUserActionNotify.json", "320_SrvUserTurn.json", "321_ClPing.json", "322_SrvPing.json", "323_ClPing.json", "324_ClUserAction.json", "325_SrvUserActionNotify.json", "326_SrvUserTurn.json", "327_SrvUserActionNotify.json", "328_SrvUserTurn.json", "329_SrvUserActionNotify.json", "330_SrvBetRoundComplete.json", "331_SrvPotCardDeal.json", "332_SrvBetRoundStart.json", "333_SrvUserTurn.json", "334_SrvUserActionNotify.json", "335_SrvUserTurn.json", "336_SrvUserActionNotify.json", "337_SrvUserTurn.json", "338_ClPing.json", "339_SrvPing.json", "340_ClPing.json", "341_ClUserAction.json", "342_SrvUserActionNotify.json", "343_SrvUserTurn.json", "344_SrvUserActionNotify.json", "345_SrvUserTurn.json", "346_SrvUserActionNotify.json", "347_SrvTableState.json", "348_SrvTransferUncalledBet.json", "349_SrvBetRoundComplete.json", "350_SrvShowHands.json", "351_SrvHandWinners.json", "352_SrvTUShowDown.json", "353_SrvTableState.json", "354_SrvTableState.json", "355_SrvTableState.json", "356_SrvFinishedOnPlace.json", "357_SrvFinishedOnPlace.json", "358_SrvTableState.json", "359_SrvTourPlayerFinished.json", "360_SrvUserStateOnTable.json", "361_SrvPlayerTourInfo.json", "362_SrvRecentWinners.json", "363_SrvTourFinishedInfo.json", "364_ClByeCommand.json", "365_ClUnsubscribeFromJackpots.json", "366_ClUnsubscribeFromSnGBeastJackpot.json", "367_ClByeCommand.json"];

	constructor()
	{

	}

	public connect(url:string, port?:number):void
	{
		this.onConnecting.dispatch();
		this.onConnected.dispatch();
		this.executeNextCommand();
	}

	public disconnect():void
	{
	}

	public send(data:any):void
	{
	}

	public destroy():void
	{
	}

	public get state():number
	{
		return PokerWebSocket.STATE_OPEN;
	}

	protected  executeNextCommand():void
	{
		if (this.commandsList.length)
		{
			this.currentCommandFile = this.commandsList.shift();
			this.loadCommandJson(this.currentCommandFile);
		}
	}

	protected loadCommandJson(json:string):void
	{
		let request = new XMLHttpRequest();
		request.onload = (e:Event) => this.onJsonLoaded(e);
		request.open("get", this.commandsDir + json, true);
		request.send();
	}

	protected onJsonLoaded(e:Event)
	{
		let request = e.target as XMLHttpRequest;
		let data:ITestData = JSON.parse(request.responseText);
		let bytesArray = data.rawBodyBytes;
		let arrayBuffer = this.getArrayBufferFromBytesArray(bytesArray);

		DevConsole.log(">> Replaying data " + this.currentCommandFile, data);

		this.onData.dispatch(arrayBuffer);

		this.executeNextCommand();
	}

	protected getArrayBufferFromBytesArray(bytes:number[]):ArrayBuffer
	{
		let result = new ArrayBuffer(bytes.length);
		let view = new Uint8Array(result);

		for (let i = 0, l = bytes.length; i < l; i++)
		{
			view[i] = bytes[i];
		}

		return result;
	}

}

interface ITestData
{
	pid:number;
	cid:number;
	name:string;
	data:Object;
	rawBodyBytes:number[];
}
